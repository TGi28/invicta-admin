import{j as c,V as B,L as C,M as P,y as V,d as i,h as l,t as b,u as o,k as r,w as g,F as $,p as E,S as N,a9 as S,D as j,o as n,B as L,g as T,aa as D,ab as F}from"./vendor-DJE8ga0U.js";/* empty css             */import{c as M,_ as I,a as R}from"./Loading-BFgnQjTV.js";const q={class:"py-6 px-10"},z={class:"invicta-form w-2/3"},A={class:"flex items-center justify-between mb-4"},G={key:0,class:"flex items-center justify-center h-full"},H={key:1,class:"w-full"},J={class:"pb-6"},K={key:0,class:"text-base font-bold pb-2"},O={class:"px-5"},Y={__name:"PermissionEdit",setup(Q){const u=N(),d=c("Permissions"),t=c(!1);B({permissions:[]});const _=c([]),m=c([]);C(()=>{f(!0)}),P(()=>u.params.id,()=>{f()});function f(e=!1){t.value=!0;let s=e?{params:{tree:!0}}:{};Invicta.fetch.get(`api${u.path}`,s).then(({data:a})=>{e&&a.tree&&(_.value=a.tree),d.value=`${a.title} Permissions`,Invicta.pageTitle(d.value),m.value=a.permissions,t.value=!1})}const h=V(()=>_.value.map(e=>({checked:!0,label:e.label,children:e.permissions.map(s=>v(s))})));function v(e){return{label:e.label,value:e.permission,checked:m.value.length?m.value.includes(e.permission):!1,children:e.children?e.children.map(s=>v(s)):[]}}function k(){t.value=!0;let e=S(M(h.value),D);Invicta.fetch.post(`api${u.path}`,{permissions:e}).then(({data:s})=>{Invicta.message(s.message),t.value=!1})}return(e,s)=>{const a=j,x=I,y=R,w=F;return n(),i("div",q,[l("div",z,[l("div",A,[l("div",null,[l("h1",null,b(o(d)),1)]),r(a,{type:"primary",onClick:k,disabled:o(t),loading:o(t)},{default:g(()=>s[0]||(s[0]=[L("Save")])),_:1},8,["disabled","loading"])]),o(t)?(n(),i("div",G,[r(x)])):(n(),i("div",H,[(n(!0),i($,null,E(o(h),p=>(n(),i("div",J,[p.label?(n(),i("header",K,b(p.label),1)):T("",!0),r(w,null,{default:g(()=>[l("div",O,[r(y,{"initial-items":p.children,disabled:!1,depth:1},null,8,["initial-items"])])]),_:2},1024)]))),256))]))])])}}};export{Y as default};
