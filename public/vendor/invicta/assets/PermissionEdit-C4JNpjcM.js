import{k as c,W as B,L as C,M as P,y as $,e as i,i as l,t as b,u as o,l as r,w as k,F as E,q as N,T,aa as V,D as L,o as n,B as S,h as j,ab as D,ac as F}from"./vendor-Ci2skXiS.js";/* empty css             */import{_ as M,a as q}from"./Loading-BjVsGdfx.js";import{c as I}from"./main-BikrXCWR.js";const R={class:"py-6 px-10"},W={class:"invicta-form w-2/3"},z={class:"flex items-center justify-between mb-4"},A={key:0,class:"flex items-center justify-center h-full"},G={key:1,class:"w-full"},H={class:"pb-6"},J={key:0,class:"text-base font-bold pb-2"},K={class:"px-5"},Z={__name:"PermissionEdit",setup(O){const u=T(),d=c("Permissions"),t=c(!1);B({permissions:[]});const p=c([]),m=c([]);C(()=>{f(!0)}),P(()=>u.params.id,()=>{f()});function f(e=!1){t.value=!0;let s=e?{params:{tree:!0}}:{};Invicta.fetch.get(`api${u.path}`,s).then(a=>{e&&a.tree&&(p.value=a.tree),d.value=`${a.title} Permissions`,Invicta.pageTitle(d.value),m.value=a.permissions,t.value=!1})}const h=$(()=>p.value.map(e=>({checked:!0,label:e.label,children:e.permissions.map(s=>v(s))})));function v(e){return{label:e.label,value:e.permission,checked:m.value.length?m.value.includes(e.permission):!1,children:e.children?e.children.map(s=>v(s)):[]}}function g(){t.value=!0;let e=V(I(h.value),D);Invicta.fetch.post(`api${u.path}`,{permissions:e}).then(s=>{Invicta.message(s.message),t.value=!1})}return(e,s)=>{const a=L,y=M,x=q,w=F;return n(),i("div",R,[l("div",W,[l("div",z,[l("div",null,[l("h1",null,b(o(d)),1)]),r(a,{type:"primary",onClick:g,disabled:o(t),loading:o(t)},{default:k(()=>s[0]||(s[0]=[S("Save")])),_:1,__:[0]},8,["disabled","loading"])]),o(t)?(n(),i("div",A,[r(y)])):(n(),i("div",G,[(n(!0),i(E,null,N(o(h),_=>(n(),i("div",H,[_.label?(n(),i("header",J,b(_.label),1)):j("",!0),r(w,null,{default:k(()=>[l("div",K,[r(x,{"initial-items":_.children,disabled:!1,depth:1},null,8,["initial-items"])])]),_:2},1024)]))),256))]))])])}}};export{Z as default};
