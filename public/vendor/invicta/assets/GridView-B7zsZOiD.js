import{a as M}from"./main-bEgEWTd2.js";import{y as x,j as h,o as t,d as o,u as e,n as N,bf as D,h as n,k as p,bn as L,B,g as l,t as C,aE as z,bo as T,f as U,w as P,bp as q,aW as G,D as j,aO as Q,bq as V,F as W,p as A,aQ as H,br as J,aD as K,ak as R,bs as X}from"./vendor-DNNQIDVf.js";/* empty css                 */const Y={key:0,enctype:"multipart/form-data",novalidate:""},Z=["multiple","accept","disabled"],ee={key:0,class:"dropbox-initial"},te={key:1,class:"dropbox-saving"},se={key:1,class:"button-upload"},oe=["multiple","accept","disabled"],ae={key:0,class:"el-icon is-loading"},ne={key:1,class:"el-icon"},le={key:2},ie={__name:"Uploader",props:{type:{type:String,default:"button"},single:{type:Boolean,default:!1},folder:String},emits:["upload-complete","open-library"],setup(i,{emit:v}){const f=i,w=v,y=Invicta.getConfig("assetsSettings"),$=x(()=>f.single?!1:y.multiupload),r=h(!0),c=h(!1),m=h(!1),u=h(),k=h(0),I=x(()=>k.value==100?"Saving to database...":"Uploading to server..."),s=_=>{m.value=!1,r.value=!1,c.value=!0;const a=_.target.files.length!==0?_.target.files:_.dataTransfer.files;if(a.length!=0)for(let b of a)g(b)},S=()=>{u.value.value=null,u.value.click()};function g(_){u.value=null;let a=new FormData;a.append("file",_),f.folder&&f.folder!=""&&a.append("folder",f.folder);const b={onUploadProgress:d=>{d.lengthComputable&&(k.value=Math.round(d.loaded*100/d.total))}};Invicta.axios.post("/api/assets",a,b).then(({data:d})=>{Invicta.message(d.message),w("upload-complete",d.asset),Invicta.emit("refresh-resource"),E()}).catch(d=>{E()})}function E(){c.value=!1,r.value=!0}return(_,a)=>{const b=M,d=G,F=j;return t(),o("div",{class:N(["image-uploader",i.type])},[e(r)||e(c)?(t(),o("form",Y,[i.type=="drag"?(t(),o("div",{key:0,class:N(["dropbox",{"is-dragover":e(m),"is-initial":e(r)}]),onDrop:D(s,["prevent"]),onDragover:a[0]||(a[0]=D(O=>m.value=!0,["prevent"])),onDragleave:a[1]||(a[1]=D(O=>m.value=!1,["prevent"]))},[n("input",{type:"file",ref_key:"uploadInput",ref:u,multiple:e($),accept:e(y).accept,class:"input-file",disabled:e(c),onChange:s},null,40,Z),e(r)?(t(),o("div",ee,[n("div",{class:"dropbox-text",onClick:S},[p(b,{icon:e(L)},null,8,["icon"]),a[3]||(a[3]=n("span",null,[B("Drop file here or "),n("strong",null,"click to select")],-1))])])):l("",!0),e(c)?(t(),o("div",te,[p(d,{type:"circle",percentage:e(k)},null,8,["percentage"]),n("div",null,C(e(I)),1)])):l("",!0)],34)):(t(),o("div",se,[n("span",{class:"el-button el-button--primary",onClick:S,title:"Upload new asset"},[n("input",{type:"file",ref_key:"uploadInput",ref:u,multiple:e($),accept:e(y).accept,class:"input-file",disabled:e(c),onChange:s},null,40,oe),e(c)?(t(),o("i",ae,[p(e(z))])):l("",!0),e(c)?l("",!0):(t(),o("i",ne,[p(e(T))])),i.type==="button"?(t(),o("span",le,"Upload")):l("",!0)]),i.type==="browse"?(t(),U(F,{key:0,icon:e(q),onClick:a[2]||(a[2]=O=>_.$emit("open-library"))},{default:P(()=>a[4]||(a[4]=[B("Media Library")])),_:1},8,["icon"])):l("",!0)]))])):l("",!0)],2)}}},re={class:"p-4"},ce={class:"assets-grid"},de=["title"],pe={class:"wrap"},ue={class:"image-wrap"},_e={key:0,class:"image-transparent-back"},fe=["src"],me={key:1,class:"p-6"},ge={key:2,class:"actions-layer"},ve={key:3,class:"actions-layer"},ye=["onClick"],ke=["onClick"],be=["onClick","title"],he=["onClick"],Ce={class:"media-details"},$e={class:"name"},we={class:"bottom"},Ie={key:0},Be={__name:"GridView",props:{resource:Object,settings:Object,selector:{type:Boolean,default:!1}},setup(i){const v=i,f=x(function(){return v.resource.data?v.resource.data:v.resource}),{isSupported:w,copy:y}=Q();V("clipboard-read"),V("clipboard-write");const $=r=>window.open(r,"_blank");return(r,c)=>{const m=ie,u=X,k=j,I=M;return t(),o("div",re,[i.selector?l("",!0):(t(),U(m,{key:0,type:"drag"})),n("div",ce,[(t(!0),o(W,null,A(e(f),(s,S)=>(t(),o("div",{class:"asset-card",key:s.path,title:s.img_name},[n("div",pe,[n("div",ue,[s.type=="image"?(t(),o("div",_e,[n("img",{src:s.src},null,8,fe)])):(t(),o("div",me,[p(u,{rows:5})])),i.selector?(t(),o("div",ge,[s.type=="image"?(t(),U(k,{key:0,type:"primary",onClick:g=>r.$emit("asset-selected",s)},{default:P(()=>c[0]||(c[0]=[B("Select Image")])),_:2},1032,["onClick"])):l("",!0)])):(t(),o("div",ve,[e(w)?(t(),o("span",{key:0,class:"copy-item",onClick:g=>e(y)(s.src),title:"Copy file path to clipboard"},[p(e(H))],8,ye)):l("",!0),s.type=="image"&&i.settings.canEdit?(t(),o("span",{key:1,class:"preview-item",onClick:g=>r.$emit("edit",s.id),title:"Click to preview image"},[p(e(J))],8,ke)):l("",!0),n("span",{class:"preview-item",onClick:g=>$(s.src),title:`Click to open ${s.type} in new tab`},[p(I,{icon:e(K)},null,8,["icon"])],8,be),i.settings.canDelete?(t(),o("span",{key:2,class:"delete-item",onClick:g=>r.$emit("delete",[s.id]),title:"Click to delete image"},[p(e(R))],8,he)):l("",!0)]))]),n("div",Ce,[n("div",$e,C(s.img_name),1),n("div",we,[s.type=="image"?(t(),o("span",Ie,C(s.dimensions)+"px",1)):l("",!0),n("span",null,C(s.size),1),n("span",null,C(s.created),1)])])])],8,de))),128))])])}}};export{ie as _,Be as a};
