import{_ as I}from"./FieldBase-CJqAS9Xu.js";import{j as c,am as F,J as R,a5 as h,o as f,f as k,w as y,k as S,aw as E,u as i,ag as N,d as $,F as j,p as P,aF as U,aG as C}from"./vendor-DNNQIDVf.js";/* empty css               */import{u as G}from"./field-B4hST7Z8.js";import{u as J}from"./FormBase-DYw9ghXD.js";/* empty css                  *//* empty css                      *//* empty css             */import"./main-bEgEWTd2.js";import"./dynamic-import-helper-BheWnx7M.js";const X={__name:"relatedSelectField",props:{formId:String,data:Object,path:String},setup(u){const a=u,m=c(!1),v=G(a),s=v.value(),w=J(a.formId),d=F(a.data,"titleField","title"),O="props"in a.data?F(a.data.props,"remote",!1):!1,B=`/api/resource/${w.settings.handle}/relationship/${a.data.id}`,o=c([]),_=c([]);R(()=>{if(O)_.value=o.value=h(s.value,e=>({key:e.id,value:{id:e.id,name:e[d]},label:e[d]}));else{let e={title:d};e=b(e),g(e)}});async function V(e){if(e!==""){let t={title:d,search:e};t=b(t),await g(t,!0)}else o.value=[]}function g(e,t=!1){m.value=!0,Invicta.axios.get(B,{params:e}).then(({data:p})=>{let n=h(p,(r,l)=>{let x="path"in a.data?Number(r):{id:Number(r)};return{key:r,value:x,label:l}});t?o.value=[..._.value,...n]:o.value=n,m.value=!1})}function b(e){return a.data.where&&(e.where=a.data.where),a.data.sortBy&&(e.sort_by=a.data.sortBy),a.data.sortOrder&&(e.sort_order=a.data.sortOrder),e}return(e,t)=>{const p=U,n=C,r=I;return f(),k(r,{"form-id":u.formId,"field-props":a,class:"related-field"},{default:y(()=>[S(n,E({modelValue:i(s),"onUpdate:modelValue":t[0]||(t[0]=l=>N(s)?s.value=l:null),valueKey:"id","remote-method":V,loading:i(m),teleported:!1,disabled:i(v).disabled},u.data.props),{default:y(()=>[(f(!0),$(j,null,P(i(o),l=>(f(),k(p,{key:l.key,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},16,["modelValue","loading","disabled"])]),_:1},8,["form-id","field-props"])}}};export{X as default};
