import{j as f,y as k,J as q,ao as D,o as r,d as _,h as o,f as d,w as m,F as N,p as T,u as e,ag as A,g as h,k as i,B as v,t as H,aF as L,aG as O,s as G,al as J,D as M}from"./vendor-DNNQIDVf.js";import{c as K,b as Q,a as W}from"./resource-CxGGqGWg.js";/* empty css               */import{_ as X}from"./CheckTree-DMv88Hj1.js";import{a as Y,_ as Z}from"./Filters-CoJGGan2.js";const ee={class:"w-full flex flex-col"},te={class:"p-3"},le={class:"flex items-center justify-between gap-2"},ae={class:"bg-white px-2 pt-2"},se={key:0,class:"flex items-center justify-center h-full"},ne={class:"pagination px-2"},oe={class:"button-row"},re={class:"mr-2"},pe={__name:"ItemsSelector",props:{resourceHandle:String,exclude:Array,requestUrl:String,titleField:String,select:{type:Array,default:[]},columns:{type:Object,default:()=>({id:{label:"ID",sortable:!0,align:"center",width:70},title:{label:"Title",sortable:!0},created:{label:"Created"}})},singleSelect:{type:Boolean,default:!1},resources:{type:Array,default:[]},where:String},emits:["selected"],setup(u,{emit:F}){const l=u,w=F,p=f(!1),t=K(`items-${l.resourceHandle}`),s=f({handle:l.resourceHandle}),b=k(()=>l.resources.length?s.value.titleField:l.titleField);q(()=>{l.resources.length&&(s.value=l.resources[0]),t.setPage(1),S()});const y=f([]),U=n=>{y.value=n},B=k(()=>y.value.map(n=>({id:n.id,[b.value]:n.title,item:D(n)}))),$=()=>{Invicta.emit("clear-filters"),w("selected",B.value)};function S(){p.value=!0;let n={paginate:!0,title:b.value,exclude:l.exclude};l.select.length&&(n.select=l.select),l.where!=""&&(n.where=l.where);let a=l.resources.length?`api/resource/${s.value.handle}/items`:l.requestUrl;Invicta.axios.get(a,{params:n}).then(({data:g})=>{t.initForm(a,g),t.getResourceFilters(s.value.handle),p.value=!1})}return(n,a)=>{const g=L,P=O,R=Q,z=Y,C=Z,V=X,E=W,I=G,j=J,x=M;return r(),_("div",ee,[o("header",te,[o("div",le,[u.resources.length?(r(),d(P,{key:0,modelValue:e(s),"onUpdate:modelValue":a[0]||(a[0]=c=>A(s)?s.value=c:null),"value-key":"handle",teleported:!1,onChange:S},{default:m(()=>[(r(!0),_(N,null,T(u.resources,c=>(r(),d(g,{key:c.handle,label:c.label,value:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):h("",!0),e(s).handle?(r(),d(R,{key:1,size:"default",handle:e(s).handle,onUpdate:e(t).setSearch},null,8,["handle","onUpdate"])):h("",!0),e(s).handle&&e(t).static.filters?(r(),d(z,{key:2,"resource-handle":e(s).handle,filters:e(t).static.filters,"active-filters":e(t).data.activeFilters},null,8,["resource-handle","filters","active-filters"])):h("",!0)])]),o("div",ae,[i(C,{badges:e(t).data.filterBadges},null,8,["badges"])]),o("main",null,[e(p)?(r(),_("div",se,[i(V)])):(r(),d(I,{key:1},{default:m(()=>[i(E,{"resource-handle":e(s).handle,data:e(t).data.resourceData,columns:u.columns,"columns-select":!1,"no-actions":!0,"single-select":u.singleSelect,onSelect:U},null,8,["resource-handle","data","columns","single-select"])]),_:1}))]),o("footer",null,[o("div",ne,[i(j,{background:"",size:"small",layout:"prev, pager, next, jumper","current-page":e(t).data.currentPage,"page-size":e(t).data.perPage,"pager-count":5,total:e(t).data.total,"onUpdate:pageSize":e(t).setPageSize,"onUpdate:currentPage":e(t).setPage},null,8,["current-page","page-size","total","onUpdate:pageSize","onUpdate:currentPage"])]),o("div",oe,[o("div",re,[a[2]||(a[2]=v("Total: ")),o("strong",null,H(e(t).total),1)]),i(x,{class:"ml-auto mr-2",text:"",onClick:a[1]||(a[1]=c=>n.$emit("cancel"))},{default:m(()=>a[3]||(a[3]=[v("Cancel")])),_:1}),i(x,{type:"primary",onClick:$},{default:m(()=>a[4]||(a[4]=[v("Select")])),_:1})])])])}}};export{pe as _};
