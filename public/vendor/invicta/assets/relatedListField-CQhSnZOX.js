import{_}from"./FieldBase-BSGhD4x6.js";import{_ as I}from"./ItemsList-C2rxzAZK.js";import{u as $}from"./FormBase-ChJL8YBd.js";import{y as p,o as b,f as w,w as k,k as v,u as n}from"./vendor-DpzuCX-L.js";import"./dropdown-menu-BywocuEX.js";import"./Loading-BgLNKlre.js";import"./main-DjFvluOL.js";import"./field-C_2VJjWP.js";import"./vuedraggable.umd-CkP7SAQI.js";import"./vue.runtime.esm-bundler-5zREEY8-.js";/* empty css             *//* empty css             */const O={__name:"relatedListField",props:{formId:String,data:Object,path:String},setup(r){const e=r,t=$(e.formId),m=`/api/resource/${t.settings.handle}/relationship/${e.data.id}`,a=e.path.split(".").pop(),d=e.path!==a,f=Invicta.can(`edit ${a}`),l=p(()=>t.get(e.path,!1)),u=p(()=>{let o=t.get(a,[]);return d&&l.value.length?l.value.map(i=>o.find(s=>s.id===i)):o});Invicta.on("resource-form-submitted",h);function c(o){if(d){let i=o.map(s=>s.id);t.set(e.path,i)}t.set(a,o)}function h(){if(console.log("we need to make a call here - where?",t.settings,e.data.id),!t.settings.id)return!1;let o=`/api/resource/${t.settings.handle}/${t.settings.id}/relationship/${e.data.id}`;Invicta.axios.get(o).then(({data:i})=>{console.log("I got this new data here",i),c(i)})}return(o,i)=>{const s=I,g=_;return b(),w(g,{"form-id":r.formId,"field-props":e,class:"related-field"},{default:k(()=>[v(s,{list:n(u),sortable:d,editable:n(f),"items-url":m,"field-data":r.data,resource:n(a),"item-id":n(t).settings.id,options:r.data.options,onUpdated:c},null,8,["list","editable","field-data","resource","item-id","options"])]),_:1},8,["form-id","field-props"])}}};export{O as default};
