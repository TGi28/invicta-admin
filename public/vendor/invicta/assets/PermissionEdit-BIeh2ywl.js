import{j as r,V as B,J as C,K as P,y as V,d as i,h as l,t as b,u as o,k as c,w as g,F as $,p as E,S as N,a9 as S,D as j,o as n,B as T,g as D,aa as F,ab as L}from"./vendor-DNNQIDVf.js";/* empty css             */import{_ as I,a as J}from"./CheckTree-DMv88Hj1.js";import{c as K}from"./functions-D7TSWOGs.js";/* empty css                 */const M={class:"py-6 px-10"},R={class:"invicta-form w-2/3"},q={class:"flex items-center justify-between mb-4"},z={key:0,class:"flex items-center justify-center h-full"},A={key:1,class:"w-full"},G={class:"pb-6"},H={key:0,class:"text-base font-bold pb-2"},O={class:"px-5"},ee={__name:"PermissionEdit",setup(Q){const u=N(),d=r("Permissions"),t=r(!1);B({permissions:[]});const _=r([]),m=r([]);C(()=>{f(!0)}),P(()=>u.params.id,()=>{f()});function f(e=!1){t.value=!0;let s=e?{params:{tree:!0}}:{};Invicta.axios.get(`api${u.path}`,s).then(({data:a})=>{e&&a.tree&&(_.value=a.tree),d.value=`${a.title} Permissions`,Invicta.pageTitle(d.value),m.value=a.permissions,t.value=!1})}const h=V(()=>_.value.map(e=>({checked:!0,label:e.label,children:e.permissions.map(s=>v(s))})));function v(e){return{label:e.label,value:e.permission,checked:m.value.length?m.value.includes(e.permission):!1,children:e.children?e.children.map(s=>v(s)):[]}}function k(){t.value=!0;let e=S(K(h.value),F);Invicta.axios.post(`api${u.path}`,{permissions:e}).then(({data:s})=>{Invicta.message(s.message),t.value=!1})}return(e,s)=>{const a=j,x=I,y=J,w=L;return n(),i("div",M,[l("div",R,[l("div",q,[l("div",null,[l("h1",null,b(o(d)),1)]),c(a,{type:"primary",onClick:k,disabled:o(t),loading:o(t)},{default:g(()=>s[0]||(s[0]=[T("Save")])),_:1},8,["disabled","loading"])]),o(t)?(n(),i("div",z,[c(x)])):(n(),i("div",A,[(n(!0),i($,null,E(o(h),p=>(n(),i("div",G,[p.label?(n(),i("header",H,b(p.label),1)):D("",!0),c(w,null,{default:g(()=>[l("div",O,[c(y,{"initial-items":p.children,disabled:!1,depth:1},null,8,["initial-items"])])]),_:2},1024)]))),256))]))])])}}};export{ee as default};
