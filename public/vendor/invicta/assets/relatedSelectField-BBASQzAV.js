import{_ as I}from"./FieldBase-BZCqSXH4.js";import{j as c,am as F,J as N,a5 as h,o as f,f as k,w as y,k as R,aw as S,u as i,ag as E,d as $,F as j,p as M,aM as P,aN as U}from"./vendor-CalzCiyh.js";import"./dropdown-menu-hHkMNFC_.js";import{u as C}from"./field-ohOzcyTb.js";import{u as J}from"./FormBase-CxW-ONTk.js";import"./Loading-BOKjay5j.js";import"./main-qjqVsijA.js";/* empty css             */import"./dynamic-import-helper-BheWnx7M.js";const W={__name:"relatedSelectField",props:{formId:String,data:Object,path:String},setup(u){const a=u,m=c(!1),v=C(a),s=v.value(),w=J(a.formId),d=F(a.data,"titleField","title"),O="props"in a.data?F(a.data.props,"remote",!1):!1,B=`/api/resource/${w.settings.handle}/relationship/${a.data.id}`,o=c([]),_=c([]);N(()=>{if(O)_.value=o.value=h(s.value,e=>({key:e.id,value:{id:e.id,name:e[d]},label:e[d]}));else{let e={title:d};e=b(e),g(e)}});async function V(e){if(e!==""){let t={title:d,search:e};t=b(t),await g(t,!0)}else o.value=[]}function g(e,t=!1){m.value=!0,Invicta.axios.get(B,{params:e}).then(({data:p})=>{let n=h(p,(r,l)=>{let x="path"in a.data?Number(r):{id:Number(r)};return{key:r,value:x,label:l}});t?o.value=[..._.value,...n]:o.value=n,m.value=!1})}function b(e){return a.data.where&&(e.where=a.data.where),a.data.sortBy&&(e.sort_by=a.data.sortBy),a.data.sortOrder&&(e.sort_order=a.data.sortOrder),e}return(e,t)=>{const p=P,n=U,r=I;return f(),k(r,{"form-id":u.formId,"field-props":a,class:"related-field"},{default:y(()=>[R(n,S({modelValue:i(s),"onUpdate:modelValue":t[0]||(t[0]=l=>E(s)?s.value=l:null),valueKey:"id","remote-method":V,loading:i(m),teleported:!1,disabled:i(v).disabled},u.data.props),{default:y(()=>[(f(!0),$(j,null,M(i(o),l=>(f(),k(p,{key:l.key,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},16,["modelValue","loading","disabled"])]),_:1},8,["form-id","field-props"])}}};export{W as default};
