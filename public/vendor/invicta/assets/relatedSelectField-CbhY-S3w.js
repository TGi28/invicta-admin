import{_ as I}from"./FieldBase-BSGhD4x6.js";import{j as f,ae as F,L as R,a5 as h,o as m,f as k,w as y,k as S,ap as E,u as i,ao as N,d as $,F as j,p as L,aG as P,aH as U}from"./vendor-DpzuCX-L.js";import"./dropdown-menu-BywocuEX.js";import{u as C}from"./field-C_2VJjWP.js";import{u as G}from"./FormBase-ChJL8YBd.js";import"./Loading-BgLNKlre.js";import"./main-DjFvluOL.js";/* empty css             */const T={__name:"relatedSelectField",props:{formId:String,data:Object,path:String},setup(u){const a=u,p=f(!1),v=C(a),s=v.value(),O=G(a.formId),d=F(a.data,"titleField","title"),w="props"in a.data?F(a.data.props,"remote",!1):!1,B=`/api/resource/${O.settings.handle}/relationship/${a.data.id}`,o=f([]),_=f([]);R(()=>{if(w)_.value=o.value=h(s.value,e=>({key:e.id,value:{id:e.id,name:e[d]},label:e[d]}));else{let e={title:d};e=g(e),b(e)}});async function V(e){if(e!==""){let t={title:d,search:e};t=g(t),await b(t,!0)}else o.value=[]}function b(e,t=!1){p.value=!0,Invicta.axios.get(B,{params:e}).then(({data:c})=>{let n=h(c,(r,l)=>{let x="path"in a.data?Number(r):{id:Number(r)};return{key:r,value:x,label:l}});t?o.value=[..._.value,...n]:o.value=n,p.value=!1})}function g(e){return a.data.where&&(e.where=a.data.where),a.data.sortBy&&(e.sort_by=a.data.sortBy),a.data.sortOrder&&(e.sort_order=a.data.sortOrder),e}return(e,t)=>{const c=P,n=U,r=I;return m(),k(r,{"form-id":u.formId,"field-props":a,class:"related-field"},{default:y(()=>[S(n,E({modelValue:i(s),"onUpdate:modelValue":t[0]||(t[0]=l=>N(s)?s.value=l:null),valueKey:"id","remote-method":V,loading:i(p),teleported:!1,disabled:i(v).disabled},u.data.props),{default:y(()=>[(m(!0),$(j,null,L(i(o),l=>(m(),k(c,{key:l.key,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},16,["modelValue","loading","disabled"])]),_:1},8,["form-id","field-props"])}}};export{T as default};
